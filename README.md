# üß™ UnitTest_demo

This project showcases a modern, robust, and efficient configuration for automating tests, ensuring code quality, and performing advanced static analysis in Python. It includes test coverage, complexity analysis, security checks, spell checking, and Mutation Testing.

---

## üìÇ Project Structure

```
UnitTest_demo/
‚îú‚îÄ‚îÄ .pre-commit-config.yaml       # Pre-commit configuration for automated checks
‚îú‚îÄ‚îÄ pyproject.toml                # Centralized configuration for Python tools
‚îú‚îÄ‚îÄ requirements.txt              # Project dependencies
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îî‚îÄ‚îÄ mutmut_check.py           # Script to run and validate Mutation Testing (mutmut)
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îî‚îÄ‚îÄ pokemon.py                # Project source code
‚îú‚îÄ‚îÄ tests/                        # Automated tests with pytest
‚îú‚îÄ‚îÄ Logs/
‚îÇ   ‚îî‚îÄ‚îÄ mutmut_survivors.md       # Detailed report of surviving mutations
‚îî‚îÄ‚îÄ htmlcov/                      # Visual report of code coverage
```

---

## üîç What does each tool do?

- **ruff**: A fast linter and formatter that combines features from `flake8`, `black`, and `isort`, ensuring high code quality and style compliance.
- **pytest**: A framework for running unit, integration, and functional tests in Python.
- **pytest-cov**: A `pytest` plugin that measures code coverage and generates detailed reports.
- **hypothesis**: A library that enables property-based and randomized testing.
- **mutmut**: A Mutation Testing tool that automatically modifies source code to detect weaknesses in test suites.
- **codespell**: Detects and automatically corrects common spelling errors in source code.
- **bandit**: A tool for identifying security issues in Python code via static analysis.
- **xenon**: Analyzes the cyclomatic complexity of Python code and ensures functions remain maintainable.

---

## üöÄ Step-by-Step Initial Setup

### 1. Prepare the virtual environment

```bash
python3 -m venv .venv
source .venv/bin/activate
```

### 2. Install dependencies

```bash
pip install -r requirements.txt
```

### 3. Make the custom script executable

```bash
chmod +x scripts/mutmut_check.py
```

### 4. Install `pre-commit` and hooks

```bash
pre-commit install
```

---

## üõ† Manual Tool Usage

### Run tests with pytest

```bash
pytest
```

### Generate coverage report

```bash
pytest --cov=src --cov-report=term-missing --cov-report=html
```

### Run Mutation Testing (mutmut)

```bash
mutmut run
mutmut results > Logs/mutmut_survivors.md
```

### Validate mutations with the custom script

```bash
python scripts/mutmut_check.py
```

### Security analysis with Bandit

```bash
bandit -c bandit.yaml -r src/
```

### Spell check with codespell

```bash
codespell src/
```

### Cyclomatic complexity check with Xenon

```bash
xenon --max-absolute B --max-modules B --max-average A src/
```

---

## üõ† Automation with pre-commit

Pre-commit automatically enforces code quality before each commit by running:

- **ruff**: Checks style, formats code, and fixes import order.
- **pytest**: Runs automated tests.
- **pytest-cov**: Validates a minimum coverage threshold of 80%.
- **codespell**: Reviews source code for spelling errors.
- **bandit**: Executes security analysis.
- **xenon**: Enforces complexity limits.
- **mutmut_check.py**: Executes mutation tests and ensures a minimum detection threshold of 80%.

To manually trigger all hooks:

```bash
pre-commit run --all-files
```

---

## ‚úÖ Expected pre-commit Output

```
graphql
CopiarEditar
ruff............................................................ Passed
pytest.......................................................... Passed
coverage_check.................................................. Passed
codespell....................................................... Passed
bandit security check........................................... Passed
xenon complexity check.......................................... Passed
mutation testing (mutmut)....................................... Passed
```

---

## üìú Generated Reports and Logs

- **Logs/mutmut_survivors.md**: Contains surviving mutations, indicating potential weaknesses in the test suite.
- **htmlcov/**: Interactive visual report of code coverage generated by `pytest-cov`.

---

## ‚öôÔ∏è Centralized Configuration (`pyproject.toml`)

All tools and dependencies are centrally configured in the `pyproject.toml` file, making maintenance and readability much easier.

---

## ‚ú® Author

Developed by **Ismael Sanrom√°n** üßë‚Äçüíª